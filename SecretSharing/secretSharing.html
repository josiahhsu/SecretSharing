<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Sharing Demo</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="secretSharing.js"></script>
</head>
<body>
    <h1>Secret Sharing Demo</h1> 
    <p>
        This is a demo of secret sharing, which is a security scheme where a message is split into <i>n</i> 
        shares. These shares are then sent to a recipient, who can reconstruct the original message by 
        recombining the <i>n</i> shares. Without all <i>n</i> shares, the original message cannot be
        recovered. As the name implies, this scheme can be used to enhance secrecy when transmitting messages.
    </p>

    <p>
        In this example, the splitting and reconstruction algorithm use a simple XOR scheme. For splitting, the plaintext is 
        converted to an array of charcodes, which are then XORed with random pads to create <i>n</i>-1 shares. The <i>n</i>th
        share is then generated by XORing all the other shares together. Recombination simply XORs these shares together to get
        the original array of charcodes. More sophisticated secret sharing schemes use methods like interpolation for splitting
        and reconstructing shares.
    </p>

    <p>
        This example sets <i>n</i> to 5. Below, you can either enter a message to be split or enter shares
        to be reconstructed. Click "Split" to split the message into 5 shares, and click "Combine" to
        combine the 5 shares into the message.
    </p>

    <script>
        let n = 5;

        function split_message()
        {
            let shares = split_plaintext(document.getElementById("plaintext").value, n)
            for (var i = 0; i < n; i++)
            {
                document.getElementById("share"+(i+1)).value = shares[i]
            }
        }

        function shareStringToByteArray(s)
        {
            return s.split(",").map(Number)
        }

        function combine_message()
        {
            let shares = []
            for (var i = 0; i < n; i++)
            {
                shares.push(shareStringToByteArray(document.getElementById("share"+(i+1)).value))
                document.getElementById("share"+(i+1)).value = shares[i]
            }
            document.getElementById("plaintext").value = combine_shares(shares)
            return shares
        }
    </script>

    <div>
        Message:
        <textarea id="plaintext" placeholder="Type your message here."></textarea>
        <button onclick="split_message()">Split</button><br><br>
    </div>

    <div>
        Shares:
        <table id="shares">
            <tr><textarea id="share1" placeholder="Share 1"></textarea></tr><br>
            <tr><textarea id="share2" placeholder="Share 2"></textarea></tr><br>
            <tr><textarea id="share3" placeholder="Share 3"></textarea></tr><br>
            <tr><textarea id="share4" placeholder="Share 4"></textarea></tr><br>
            <tr><textarea id="share5" placeholder="Share 5"></textarea></tr><br>
        </table>
        
        <button onclick="combine_message()">Combine</button>
    </div>
</body>
